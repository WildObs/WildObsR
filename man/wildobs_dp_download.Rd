% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wildobs_dp_download.R
\name{wildobs_dp_download}
\alias{wildobs_dp_download}
\title{Download Data from WildObs' MongoDB and Format as Frictionless Data Packages}
\usage{
wildobs_dp_download(
  db_url = NULL,
  api_key = NULL,
  project_ids,
  media = FALSE,
  metadata_only = FALSE
)
}
\arguments{
\item{db_url}{A character string specifying the MongoDB connection URI. This should follow the format:
\code{'mongodb://username:password@host:port/database'}. If \code{NULL}, the function will stop with an error.
This parameter allows users to specify their own connection string to the WildObs MongoDB instance.}

\item{api_key}{A character string specifying the API key used for authenticated access to the WildObs
public API. If provided, the function will query the API instead of connecting directly to the MongoDB
instance with \code{mongolite}. API keys grant read-only access to specific endpoints and should be kept
confidential (e.g., stored in an \code{.Renviron} file or other secure environment variable).
Defaults to \code{NULL}, in which case the function expects a valid \code{db_url} to connect directly to MongoDB.}

\item{project_ids}{A character vector of project IDs to retrieve from MongoDB, which is generated from from a query to WildObs' MongoDB.}

\item{media}{A logical (TRUE/FALSE) value to include the media resource in your data package download. This is the largest spreadsheet and significantly slows down the download process, so this value defaults to FALSE.}

\item{metadata_only}{Logical; if TRUE, only metadata will be retrieved from each data package, without downloading the associated data resources. This can significantly improve speed when only project-level information is required. Defaults to FALSE, in which case all data (metadata and tabular resources) are downloaded.}
}
\value{
A named list of Frictionless Data Packages formatted using camtrap DP, where each element corresponds to a project. To learn more about \href{https://camtrap-dp.tdwg.org/}{camtrapDP, click here}, and to learn more about \href{https://specs.frictionlessdata.io/data-package/}{Frictionless Data Packages, click here}. Note that only data with an 'open' data sharing agreement will return tabular data, while data shared with a  'partial' data sharing agreement will return only the project-level metadata.
}
\description{
This function connects to the WildObs MongoDB server, retrieves project-specific
metadata and data resources, and bundles them into Frictionless Data Packages formatted using the camtrap DP data standard.
}
\details{
The function performs the following steps:
\enumerate{
\item Connects to MongoDB using read-only credentials.
\item Retrieves project-level metadata and formats it to match the Frictionless Data Package structure.
\item Queries the \code{deployments}, \code{observations}, and \code{media} collections for the requested projects.
\item Applies schemas to ensure data integrity.
\item Creates Frictionless Data Packages and returns them as a list.
}

@seealso
\code{\link{convert_df_to_list}} for formatting metadata,
\code{\link{clean_list_recursive}} for removing NULL and empty elements,
\code{\link{reformat_fields}}, \code{\link{reformat_schema}}, and \code{\link{apply_schema_types}} for processing and applying schema fields,
\code{\link{is_empty_spatial}} and \code{\link{is_empty_temporal}} for removing empty spatio-temporal fields.
}
\examples{
\dontrun{
# Example usage:
# Load the general use WildObs API key
api_key <- "f4b9126e87c44da98c0d1e29a671bb4ff39adcc65c8b92a0e7f4317a2b95de83"

# Load relevant project ids
project_ids <- c("QLD_Kgari_BIOL2015_2023-24_WildObsID_0004",
                 "QLD_Kgari_potoroos_Amir_2022_WildObsID_0003")

dp_list <- wildobs_dp_download(project_ids)

# Access the data for a specific project
dp_list[["QLD_Kgari_BIOL2015_2023-24_WildObsID_0004"]]
}

}
\author{
Zachary Amir
}
